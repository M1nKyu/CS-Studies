---
created: 2025-01-15 19:00
category:
  - database
tags:
  - TIL
---
## ⭐ DROP과 TRUNCATE (+ DELETE)
#### 🍪 DROP 란
```SQL
DROP TABLE table_name;
```
- **테이블 자체를 삭제**한다.
- 해당 테이블과 관련된 모든 *데이터, 구조, 인덱스, 제약 조건* 등이 완전히 삭제된다.
- 삭제된 데이터와 테이블은 **복구할 수 없다**.
---
#### 🍪 TRUNCATE 란
```sql
TRUNCATE TABLE table_name;
```
- 테이블의 **모든 데이터를 삭제**하지만, 테이블 구조와 관련된 정의는 유지한다.
- 데이터만 삭제되며, **구조(스키마)나 인덱스는 유지**한다.
- 일반적으로 **롤백 불가능**. 하지만 DBMS에 따라 다를 수 있다. `(예: MySQL의 경우 InnoDB는 롤백 가능)`
- 데이터 삭제 시 로그를 최소화해 성능이 더 빠르다.
- DELETE와 달리 트리거가 실행되지 않는다.
---
#### 🍪 DELETE 란
```SQL
# 특정 조건에 따라 삭제
DELETE FROM table_name
WHERE column_name = 'value';

# 모든 데이터 삭제
DELETE FROM table_name; 
```
- 삭제 대상 데이터를 조건에 따라 선택할 수 있다.
- **트랜잭션**에 포함될 수 있으므로 **롤백이 가능**하다.
- 테이블에 정의된 **트리거(Trigger)가 실행**된다.
- 삭제 작업은 데이터베이스 **로그에 기록**되므로 비교적 느릴 수 있다.
- **데이터만 삭제**하며, 테이블의 구조와 인덱스는 유지된다.

#### 🍪 DROP, TRUNCATE, DELETE 의 차이


![이미지](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99A5253F5DC1723107)
	- [이미지 출처](https://lee-mandu.tistory.com/476)

###### 🍬 DELETE, TRUNCATE, DROP 비교 표

| **특징**          | DELETE                | TRUNCATE                    | DROP                        |
| --------------- | --------------------- | --------------------------- | --------------------------- |
| **기능**          | 특정 데이터 삭제 <br>(조건 가능) | 모든 데이터 삭제 <br>(조건 불가능)      | 테이블 전체 삭제 <br>(데이터 + 구조 제거) |
| **WHERE 사용 가능** | 가능                    | 불가능                         | 불가능                         |
| **트랜잭션 지원**     | 지원 (롤백 가능)            | 일반적으로 지원하지 않음 (DBMS에 따라 다름) | 지원하지 않음                     |
| **트리거 실행 여부**   | 실행                    | 실행되지 않음                     | 실행되지 않음                     |
| **속도**          | 느림 (로그 기록 및 조건 평가)    | 빠름 (로그 최소화)                 | 빠름 (테이블 제거)                 |
| **테이블 구조**      | 유지                    | 유지                          | 삭제됨                         |
| **인덱스 유지**      | 유지                    | 유지                          | 삭제됨                         |
| **로그 기록**       | 모든 삭제 작업 로그 기록        | 최소 로그 기록                    | 로그 기록 없음                    |
| **복구 가능 여부**    | 가능 (트랜잭션 롤백 시)        | 복구 불가능                      | 복구 불가능                      |
| **사용 목적**       | 조건부 데이터 삭제            | 대량 데이터 삭제 또는 초기화            | 테이블 자체 삭제                   |
| **제약 조건 고려**    | 외래 키 제약 조건 확인 필요      | 외래 키 제약 조건이 있을 경우 사용 불가     | 외래 키 제약 조건에 영향 없음           |
> 속도
> 	- TRUNCATE > DELETE > DROP (속도 비교에서 TRUNCATE가 가장 빠르다.)
> 	- **DROP**은 테이블을 **전체적으로 제거**하며, 테이블과 관련된 **모든 리소스**를 삭제하고 로그를 기록 -> 시간이 더 많이 소요
> 	- **TRUNCATE**는 **데이터만 삭제**하고, 테이블 구조는 그대로 유지
> 	- **DELETE**는 조건에 맞는 데이터만 삭제하지만 트랜잭션과 트리거 등이 처리되어야 함 -> **TRUNCATE**보다 느리고, **DROP**보다 빠름.

> 트랜잭션 지원? :
> 	- 여러 SQL 명령을 하나의 작업처럼 묶어 실행하고, 모든 작업이 성공적으로 완료될 경우 `commit`으로 확정하고, 실패할 경우 `rollback`으로 이전 상태로 되돌릴 수 있다는 의미
> 	- **DELETE**는 트랜잭션을 지원하여, 삭제 작업 중에 오류가 발생하면 롤백하여 데이터베이스의 일관성 유지 가능

> 트리거? :
> 	- 특정 이벤트(예: 데이터 삽입, 삭제, 수정)가 발생할 때 자동으로 실행되는 **저장된 절차**
> 	- [블로그-트리거란?](https://benggri.tistory.com/78)
---
#### 실제 사용
###### 🍬 DELETE
- 로그 테이블에서 오래된 데이터 삭제
	- ex: 30일 이상 된 로그 데이터 삭제할 때 사용
- 주문 상태 변경 후 데이터 삭제
	- 주문 완료 또는 취소된 주문 데이터를 삭제할 때 조건을 지정하여 삭제
- 트리거 실행
	- ex: 삭제된 데이터를 다른 테이블에 기록, 알림을 전송하는 동작이 필요할 때

###### 🍬 TRUNCATE
- 테이블 초기화
	- ex: 중간 결과 테이블에서 임시 데이터를 삭제하여 새 데이터를 삽입할 준비를 할 때 사용
- 테스트 데이터 삭제
	- 테스트 데이터 테이블에서 모든 데이터를 삭제하고 새로 데이터를 삽입할 때
- 빠른 성능 필요
	- **대량 데이터를 삭제**해야 할 때, **로그를 최소화**하고 **성능이 중요**한 경우

###### 🍬 DROP
- 테이블 구조 변경 시
	- 테이블을 완전히 제거하고 새 테이블을 만들어야 할 때
	- ex: 데이터베이스 스키마 변경으로 인해 구조 자체를 변경해야 하는 경우, 기존 테이블을 제거하고 새로운 테이블을 생성
- 임시 테이블 삭제
	- 임시 테이블이 더 이상 필요하지 않을 때
- 사용되지 않는 테이블 삭제
	- 더 이상 사용되지 않거나 필요 없는 테이블을 데이터베이스에서 제거
---
## 🧙‍♂️ 요약
- **DROP**: 테이블 및 관련 **모든 데이터, 구조, 인덱스, 제약 조건을 완전히 삭제**. 트랜잭션 및 트리거 없음. 
- **TRUNCATE**: 테이블의 **데이터만 모두 삭제**, 구조는 유지. 트랜잭션 지원 안함, 트리거 실행 안됨. 
- **DELETE**: **조건에 맞는 데이터 삭제**. 트랜잭션 및 트리거 지원.

- 속도: TRUNCATE > DELETE > DROP

- 사용
	- **DELETE**: 조건에 맞는 데이터 삭제, 트랜잭션과 트리거 지원 필요할 때 사용.
	- **TRUNCATE**: 전체 데이터 삭제, 빠른 성능과 대량 삭제 필요할 때 사용.
	- **DROP**: 테이블 자체 제거, 구조 변경이나 임시 테이블 삭제 필요할 때 사용.
---
> **참고사이트**
> - [01](https://lee-mandu.tistory.com/476)
> - ChatGPT
